 AS V1.42 Beta [Bld 298] - Source File Sonic.68k - Page 1 - 12/17/2025 22:12:31


       1/       0 :                     ; Naming conventions:
       2/       0 :                     ; variableValue
       3/       0 :                     ; CONSTANT_VALUE
       4/       0 :                     ; MainRoutineAndLables
       5/       0 :                     ; sub_routine
       6/       0 :                     
       7/       0 :                     	include "Variables.asm"
(1)    1/       0 :                     ; It is recommended to fill padding spaces with byte variables for the 68k,
(1)    2/       0 :                     ; to avoid wasting memory space and make it uneven. With padding on,
(1)    3/       0 :                     ; the assembler will automatically fill odd words and longs to make them even and to avoid crashing.
(1)    4/       0 :                     
(1)    5/FFFF0000 :                     	org $FFFF0000
(1)    6/FFFF0000 :                     ; 68000 variables
(1)    7/FFFF0000 :                     sampleIndex:	ds.l 1	; Samples after Z80 routine execution
(1)    8/FFFF0004 :                     shouldStop:		ds.b 1	; It's zero when the execution continues
(1)    9/FFFF0005 :                     
(1)   10/    1000 :                     	org $1000
(1)   11/    1000 :                     ; Z80 variables (away from code)
(1)   12/    1000 :                     playedSamplesHigh:	ds.b 1
(1)   13/    1001 :                     	ds.b 1
(1)   14/    1002 :                     playedSamplesLow:	ds.b 1
       8/    1003 :                     	include "Constants.asm"
(1)    1/    1003 :                     ; Memory spaces
(1)    2/    1003 : =$FF0000            WRAM_ADDR:	equ $FF0000		; Work memory starting address
(1)    3/    1003 : =$A10009            JOY_CTRL:	equ $A10009		; 1P control port
(1)    4/    1003 : =$A10003            JOY_DATA:	equ $A10003   	; 1P data port
(1)    5/    1003 : =$FF0000            SYS_STACK:	equ $FF0000
(1)    6/    1003 :                     
(1)    7/    1003 :                     ; Various memory space sizes in bytes
(1)    8/    1003 : =$10000             WRAM_SIZE: 	equ 65536
(1)    9/    1003 : =$10000             VRAM_SIZE:	equ 65536
(1)   10/    1003 : =$50                VSRAM_SIZE:	equ 80
(1)   11/    1003 : =$80                CRAM_SIZE:	equ 128
(1)   12/    1003 :                     
(1)   13/    1003 :                     ; VDP memory spaces
(1)   14/    1003 : =$C00000            VDP_DATA:    	equ $C00000		; VDP data port
(1)   15/    1003 : =$C00004            VDP_CTRL:    	equ $C00004		; VDP control port
(1)   16/    1003 : =$C00008            VDP_HVCOUNTER:  equ $C00008		; H/V counter
(1)   17/    1003 :                     
(1)   18/    1003 : =$40000000          VRAM:	equ	$40000000	; Video memory address control
(1)   19/    1003 : =$40000010          VSRAM:	equ $40000010	; Vertical scroll memory address control
(1)   20/    1003 : =$C0000000          CRAM: 	equ $C0000000	; Color memory address control
(1)   21/    1003 :                     
(1)   22/    1003 : =$40000080          VRAM_DMA_CMD:   equ $40000080	; DMA VRAM control
(1)   23/    1003 : =$40000090          VSRAM_DMA_CMD:  equ $40000090	; DMA VSRAM control
(1)   24/    1003 : =$C0000080          CRAM_DMA_CMD:   equ $C0000080	; DMA CRAM control
(1)   25/    1003 :                     
(1)   26/    1003 : =$FFFF              PLANEA_ADDR:	equ $FFFF		; Plane A name table address
(1)   27/    1003 : =$FFFF              PLANEB_ADDR:	equ $FFFF		; Plane B name table address
(1)   28/    1003 : =$FFFF              SPRITE_ADDR:	equ $FFFF		; Sprite name table address
(1)   29/    1003 : =$FFFF              WINDOW_ADDR:	equ $FFFF		; Window plane name table address
(1)   30/    1003 : =$FFFF              HSCROLL_ADDR:	equ $FFFF		; Plane x coordinate
(1)   31/    1003 :                     
(1)   32/    1003 :                     ; VDP registers
(1)   33/    1003 : =$8000              VDPREG_MODE1:     equ $8000  ; Mode register #1
(1)   34/    1003 : =$8100              VDPREG_MODE2:     equ $8100  ; Mode register #2
(1)   35/    1003 : =$8B00              VDPREG_MODE3:     equ $8B00  ; Mode register #3
(1)   36/    1003 : =$8C00              VDPREG_MODE4:     equ $8C00  ; Mode register #4
(1)   37/    1003 :                     
(1)   38/    1003 : =$8200              VDPREG_PLANEA:    equ $8200  ; Plane A table address
 AS V1.42 Beta [Bld 298] - Source File Sonic.68k(Constants.asm) - Page 2 - 12/17/2025 22:12:31


(1)   39/    1003 : =$8400              VDPREG_PLANEB:    equ $8400  ; Plane B table address
(1)   40/    1003 : =$8500              VDPREG_SPRITE:    equ $8500  ; Sprite table address
(1)   41/    1003 : =$8300              VDPREG_WINDOW:    equ $8300  ; Window table address
(1)   42/    1003 : =$8D00              VDPREG_HSCROLL:   equ $8D00  ; HScroll table address
(1)   43/    1003 :                     
(1)   44/    1003 : =$9000              VDPREG_SIZE:      equ $9000  ; Plane A and B size
(1)   45/    1003 : =$9100              VDPREG_WINX:      equ $9100  ; Window X split position
(1)   46/    1003 : =$9200              VDPREG_WINY:      equ $9200  ; Window Y split position
(1)   47/    1003 : =$8F00              VDPREG_INCR:      equ $8F00  ; Autoincrement
(1)   48/    1003 : =$8700              VDPREG_BGCOL:     equ $8700  ; Background color
(1)   49/    1003 : =$8A00              VDPREG_HRATE:     equ $8A00  ; HBlank interrupt rate
(1)   50/    1003 :                     
(1)   51/    1003 : =$9300              VDPREG_DMALEN_L:  equ $9300  ; DMA length (low)
(1)   52/    1003 : =$9400              VDPREG_DMALEN_H:  equ $9400  ; DMA length (high)
(1)   53/    1003 : =$9500              VDPREG_DMASRC_L:  equ $9500  ; DMA source (low)
(1)   54/    1003 : =$9600              VDPREG_DMASRC_M:  equ $9600  ; DMA source (mid)
(1)   55/    1003 : =$9700              VDPREG_DMASRC_H:  equ $9700  ; DMA source (high)
(1)   56/    1003 :                     
(1)   57/    1003 :                     ; VDP name table addresses
(1)   58/    1003 : =$0                 NOFLIP: equ $0000  ; Don't flip (default)
(1)   59/    1003 : =$800               HFLIP:  equ $0800  ; Flip horizontally
(1)   60/    1003 : =$1000              VFLIP:  equ $1000  ; Flip vertically
(1)   61/    1003 : =$1800              HVFLIP: equ $1800  ; Flip both ways (180Â° flip)
(1)   62/    1003 :                     
(1)   63/    1003 : =$0                 PAL0:   equ $0000  ; Use palette 0 (default)
(1)   64/    1003 : =$2000              PAL1:   equ $2000  ; Use palette 1
(1)   65/    1003 : =$4000              PAL2:   equ $4000  ; Use palette 2
(1)   66/    1003 : =$6000              PAL3:   equ $6000  ; Use palette 3
(1)   67/    1003 :                     
(1)   68/    1003 : =$0                 LOPRI:  equ $0000  ; Low priority (default)
(1)   69/    1003 : =$8000              HIPRI:  equ $8000  ; High priority
(1)   70/    1003 :                     
(1)   71/    1003 :                     ; Palette data sizes
(1)   72/    1003 : =$60                PAT_BodyFont_SIZE_T:	equ 96
(1)   73/    1003 : =$C00               PAT_BodyFont_SIZE_B:	equ 96*32
(1)   74/    1003 :                     
(1)   75/    1003 :                     ; Z80 control
(1)   76/    1003 : =$A00000            Z80_RAM:	equ $A00000	; Z80 RAM start
(1)   77/    1003 : =$A11100            Z80_BUSREQ:	equ $A11100	; Z80 bus request line
(1)   78/    1003 : =$A11200            Z80_RESET:	equ $A11200	; Z80 reset line
(1)   79/    1003 :                     
(1)   80/    1003 :                     ; Controller labels
(1)   81/    1003 : =$5                 JOY_C:	equ 5
(1)   82/    1003 : =$4                 JOY_B:	equ 4
(1)   83/    1003 : =$3                 JOY_R:	equ 3
(1)   84/    1003 : =$2                 JOY_L:	equ 2
(1)   85/    1003 : =$1                 JOY_D:	equ 1
(1)   86/    1003 : =$0                 JOY_U:	equ 0
(1)   87/    1003 :                     
(1)   88/    1003 : =$4000              YM2612_CONTROL:	equ $4000
(1)   89/    1003 : =$4001              YM2612_DATA:	equ $4001
(1)   90/    1003 : =$2A                DAC_IN:			equ $2A
(1)   91/    1003 : =$2B                DAC_ENABLE:		equ $2B
       9/    1003 :                     	include "Macros.asm"
      11/    1003 :                     	listing purecode ; We sure want the listing file, but only the final code in expanded macros
      12/    1003 :                     
      13/    1003 :                     ; These switches enable the entire purpose of this driver and disabling them likely makes the playback similar to "traditional" DAC drivers
      14/    1003 : =$1                 smoothPlayback:	equ TRUE	; Put it to FALSE to prevent 68k output during buffer load
      15/    1003 : =$1                 accurateSpeed:	equ TRUE	; Put it to FALSE to ignore 68k sample increment calculation
      16/    1003 :                     
      17/       0 :                     	org 0
      18/       0 :                     
      19/       0 :                     RomStart ; Vectors
      20/       0 : 00FF 0000           		dc.l SYS_STACK			; Initial stack pointer value (SP value)
      21/       4 : 0000 0646           		dc.l EntryPoint			; Start of program (PC value)
      22/       8 : 0000 0200           		dc.l BusError			; Bus error
      23/       C : 0000 0206           		dc.l AddressError		; Address error
      24/      10 : 0000 020C           		dc.l IllegalInstruction	; Illegal instruction
      25/      14 : 0000 0212           		dc.l DivisionByZero		; Division by zero
      26/      18 : 0000 0218           		dc.l CHKException		; CHK exception
      27/      1C : 0000 021E           		dc.l TRAPVException		; TRAPV exception
      28/      20 : 0000 0224           		dc.l PrivilegeViolation	; Privilege violation
      29/      24 : 0000 022A           		dc.l TRACEException		; TRACE exception
      30/      28 : 0000 0230           		dc.l LineAEmulator		; Line-A emulator
      31/      2C : 0000 0236           		dc.l LineFEmulator		; Line-F emulator
      32/      30 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      33/      34 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      34/      38 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      35/      3C : 0000 0242           		dc.l GenericError		; Unused (reserved)
      36/      40 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      37/      44 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      38/      48 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      39/      4C : 0000 0242           		dc.l GenericError		; Unused (reserved)
      40/      50 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      41/      54 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      42/      58 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      43/      5C : 0000 0242           		dc.l GenericError		; Unused (reserved)
      44/      60 : 0000 023C           		dc.l SpuriousException	; Spurious exception
      45/      64 : 0000 0242           		dc.l GenericError		; IRQ level 1
      46/      68 : 0000 0242           		dc.l GenericError		; IRQ level 2
      47/      6C : 0000 0242           		dc.l GenericError		; IRQ level 3 
      48/      70 : 0000 0242           		dc.l GenericError		; IRQ level 4 (horizontal retrace interrupt)
      49/      74 : 0000 0242           		dc.l GenericError		; IRQ level 5
      50/      78 : 0000 0248           		dc.l VDP_VBlank			; IRQ level 6 (vertical retrace interrupt)
      51/      7C : 0000 0242           		dc.l GenericError		; IRQ level 7
      52/      80 : 0000 0242           		dc.l GenericError		; TRAP #00 exception
      53/      84 : 0000 0242           		dc.l GenericError		; TRAP #01 exception
      54/      88 : 0000 0242           		dc.l GenericError		; TRAP #02 exception
      55/      8C : 0000 0242           		dc.l GenericError		; TRAP #03 exception
      56/      90 : 0000 0242           		dc.l GenericError		; TRAP #04 exception
      57/      94 : 0000 0242           		dc.l GenericError		; TRAP #05 exception
      58/      98 : 0000 0242           		dc.l GenericError		; TRAP #06 exception
      59/      9C : 0000 0242           		dc.l GenericError		; TRAP #07 exception
      60/      A0 : 0000 0242           		dc.l GenericError		; TRAP #08 exception
      61/      A4 : 0000 0242           		dc.l GenericError		; TRAP #09 exception
      62/      A8 : 0000 0242           		dc.l GenericError		; TRAP #10 exception
      63/      AC : 0000 0242           		dc.l GenericError		; TRAP #11 exception
      64/      B0 : 0000 0242           		dc.l GenericError		; TRAP #12 exception
      65/      B4 : 0000 0242           		dc.l GenericError		; TRAP #13 exception
      66/      B8 : 0000 0242           		dc.l GenericError		; TRAP #14 exception
      67/      BC : 0000 0242           		dc.l GenericError		; TRAP #15 exception
      68/      C0 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      69/      C4 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      70/      C8 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      71/      CC : 0000 0242           		dc.l GenericError		; Unused (reserved)
      72/      D0 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      73/      D4 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      74/      D8 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      75/      DC : 0000 0242           		dc.l GenericError		; Unused (reserved)
      76/      E0 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      77/      E4 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      78/      E8 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      79/      EC : 0000 0242           		dc.l GenericError		; Unused (reserved)
      80/      F0 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      81/      F4 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      82/      F8 : 0000 0242           		dc.l GenericError		; Unused (reserved)
      83/      FC : 0000 0242           		dc.l GenericError		; Unused (reserved)
      84/     100 :                     
      85/     100 :                     ; ROM header
      86/     100 : 5345 4741 204D 4547 		dc.b "SEGA MEGA DRIVE",$20				; "$20" is padding
              108 : 4120 4452 4956 4520
      87/     110 : 2843 2942 524F 3020 		dc.b "(C)BRO0 2024.OCT"					; Copyright(-ish), release year and month
              118 : 3230 3234 2E4F 4354
      88/     120 : 5072 6573 656E 7461 		dc.b "Presentazione sistemi: 68k e x86"	; Domestic name
              128 : 7A69 6F6E 6520 7369
              130 : 7374 656D 693A 2036
              138 : 386B 2065 2078 3836
      89/     140 : 2020 2020 2020 2020 		dc.b "                "					; padding
              148 : 2020 2020 2020 2020
      90/     150 : 5072 6573 656E 7461 		dc.b "Presentazione sistemi: 68k e x86"	; Overseas name
              158 : 7A69 6F6E 6520 7369
              160 : 7374 656D 693A 2036
              168 : 386B 2065 2078 3836
      91/     170 : 2020 2020 2020 2020 		dc.b "                "					; padding
              178 : 2020 2020 2020 2020
      92/     180 : 4149 2D32 3334 3536 		dc.b "AI-23456786-00"					; Serial number (I mashed the keyboard for this)
              188 : 3738 362D 3030   
      93/     18E : 0000                		dc.w $0000								; Empty checksum
      94/     190 : 4A                  		dc.b "J"								; Joypad type
      95/     191 : 2020 2020 2020 2020 		dc.b "               "					; padding
              199 : 2020 2020 2020 20
      96/     1A0 : 0000 0000           		dc.l RomStart							; Start address of ROM
      97/     1A4 : 003F B308           		dc.l RomEnd								; End address of ROM
      98/     1A8 : 00FF 0000           		dc.l $FF0000							; Start address of WRAM
      99/     1AC : 00FF FFFF           		dc.l $FFFFFF 							; End address of WRAM
     100/     1B0 : 2020 2020 2020 2020 		dc.b "                                                                "
              1B8 : 2020 2020 2020 2020
              1C0 : 2020 2020 2020 2020
              1C8 : 2020 2020 2020 2020
              1D0 : 2020 2020 2020 2020
              1D8 : 2020 2020 2020 2020
              1E0 : 2020 2020 2020 2020
              1E8 : 2020 2020 2020 2020
     101/     1F0 : 4A55 20             		dc.b "JU "								; Region support
     102/     1F3 : 2020 2020 2020 2020 		dc.b "             "					; padding for reserved space
              1FB : 2020 2020 20      
     103/     200 :                     
     104/     200 :                     ; Error handler jump table
     105/     200 :                     
     106/     200 :                     BusError:
     107/     200 : 7E01                	moveq	#1,d7
     108/     202 : 4E72 2700           	stop #$2700
     109/     206 :                     
     110/     206 :                     AddressError:
     111/     206 : 7E02                	moveq	#2,d7
     112/     208 : 4E72 2700           	stop #$2700
     113/     20C :                     
     114/     20C :                     IllegalInstruction:
     115/     20C : 7E03                	moveq	#3,d7
     116/     20E : 4E72 2700           	stop #$2700
     117/     212 :                     
     118/     212 :                     DivisionByZero:
     119/     212 : 7E04                	moveq	#4,d7
     120/     214 : 4E72 2700           	stop #$2700
     121/     218 :                     
     122/     218 :                     CHKException:
     123/     218 : 7E05                	moveq	#5,d7
     124/     21A : 4E72 2700           	stop #$2700
     125/     21E :                     
     126/     21E :                     TRAPVException:
     127/     21E : 7E06                	moveq	#6,d7
     128/     220 : 4E72 2700           	stop #$2700
     129/     224 :                     
     130/     224 :                     PrivilegeViolation:
     131/     224 : 7E07                	moveq	#7,d7
     132/     226 : 4E72 2700           	stop #$2700
     133/     22A :                     
     134/     22A :                     TRACEException:
     135/     22A : 7E08                	moveq	#8,d7
     136/     22C : 4E72 2700           	stop #$2700
     137/     230 :                     
     138/     230 :                     LineAEmulator:
     139/     230 : 7E09                	moveq	#9,d7
     140/     232 : 4E72 2700           	stop #$2700
     141/     236 :                     
     142/     236 :                     LineFEmulator:
     143/     236 : 7E0A                	moveq	#10,d7
     144/     238 : 4E72 2700           	stop #$2700
     145/     23C :                     
     146/     23C :                     SpuriousException:
     147/     23C : 7E0B                	moveq	#11,d7
     148/     23E : 4E72 2700           	stop #$2700
     149/     242 :                     
     150/     242 :                     GenericError:
     151/     242 : 7E0C                	moveq	#12,d7
     152/     244 : 4E72 2700           	stop #$2700
     153/     248 :                     
     154/     248 :                     ; A2: live samples, A0: Z80 samples for later
     155/     248 :                     ; 240 68k cycles for every 32 kHz sample
     156/     248 :                     
     157/     248 :                     VDP_VBlank:
     158/     248 :                     ; --- ~20 cycles in total ---
     159/     248 : 47F9 00A0 4001      	lea	YM2612_DATA|Z80_RAM,a3			; 8 cycles
     160/     24E : 49F9 00A0 1000      	lea	playedSamplesHigh|Z80_RAM,a4	; 8 cycles
     161/     254 : 4BF9 00A1 1100      	lea Z80_BUSREQ,a5					; 8 cycles
     162/     25A : 323C 0100           	move.w	#$100,d1					; 8 cycles
     163/     25E : 2439 FFFF 0000      	move.l	(sampleIndex),d2			; 12 cycles
     164/     264 : 7600                	moveq	#0,d3						; 4 cycles
     165/     266 :                     ; --- 68 cycles in total ---
     166/     266 : 700A                	moveq	#10,d0		; The high 16-bit portion clears, 4 cycles
     167/     268 :                     $$z80_wait:
     168/     268 : 51C8 FFFE           	dbf d0,$$z80_wait	; 114 cycles
     169/     26C :                     ; --- 186 cycles in total ---
     170/     26C : (MACRO)[0]          	stopZ80 d1,a5		; Initiate Z80 stop, 8 cycles
     170/     26C :                     
     170/     26C : 3A81                                        move.w  d1,(a5)
     171/     26E : (MACRO)[1]          	waitZ80	d3,a5		; 12 cycles (at best)
     171/     26E :                     
     171/     26E :                     
     171/     26E :                     
     171/     26E :                     $$wait: 
     171/     26E : 0715                        btst    d3,(a5)
     171/     270 : 66FC                        bne.s   $$wait
     172/     272 :                     ; --- 206 cycles in total ---
     173/     272 : 301C                	move.w	(a4)+,d0	; Get high byte of playedSamples, 8 cycles
     174/     274 : 1014                	move.b	(a4),d0		; Get lower byte of playedSamples, 8 cycles
     175/     276 : D480                	add.l	d0,d2		; 8 cycles
     176/     278 : 2442                	movea.l	d2,a2		; Sample index while executing 68k routine, 4 cycles
     177/     27A :                     ; --- 234 cycles in total ---
     179/     27A : 169A                		move.b	(a2)+,(a3)	; Output sample, 12 cycles
     184/     27C :                     
     185/     27C :                     ; --- Cycle count restarts ---
     186/     27C :                     
     187/     27C : 2042                	movea.l	d2,a0	; 4 cycles
     188/     27E :                     
     190/     27E : (MACRO)[2]          		addaq	21+2,a0	; Sample index after 68k routine execution (A2 at the end, basically), 8 cycles
     190/     27E :                     
     190/     27E :                     
     190/     27E :                     
     190/     27E : 41E8 0017                   lea (21+2,a0),a0
     191/     282 : 2408                		move.l	a0,d2	; D2 is now the updated sample index, 4 cycles
     193/     284 :                     
     194/     284 : 43F9 00A0 0090      	lea	SampleBuffer|Z80_RAM,a1	; 8 cycles
     195/     28A :                     ; --- 24 cycles in total ---
     196/     28A : 0802 0000           	btst	#0,d2				; Is the sample index even? 6 cycles
     197/     28E : 6706                	beq.s	$$skip_alignment	; If yes, skip the alignment, 10 cycles
     198/     290 : 1298                	move.b	(a0)+,(a1)			; If not, the 68k will crash, so we avoid it. 12 cycles
     199/     292 : 5489                	addq.l	#2,a1
     200/     294 : 2408                	move.l	a0,d2	; D2 is now the updated sample index, 4 cycles
     201/     296 :                     $$skip_alignment:
     202/     296 : 4E71                	nop			; 4 cycles
     203/     298 : 4E71                	nop			; 4 cycles
     204/     29A : 4E71                	nop			; 4 cycles
     205/     29C : 223C 003F B308      	move.l	#RomEnd,d1			; 12 cycles
     206/     2A2 : B282                	cmp.l	d2,d1				; Is the audio about to end (ends on Z80 buffer)? 8 cycles
     207/     2A4 :                     ; --- 72 cycles in total ---
     208/     2A4 : 6C22                	bge.s	$$skip_tracking		; 10 cycles on branch, 8 cycles no branch
     209/     2A6 :                     	; Z80 playback with sample tracking routine
     210/     2A6 : 13FC 0065 00A0 0060 	move.b	#Loop_EndSoundInit,(Z80RoutineAddress+2)|Z80_RAM	; Little endian, 16 cycles
     211/     2AE : 9481                	sub.l	d1,d2	; D2 is now the distance to the end of the audio (after 68k execution), 8 cycles
     212/     2B0 : 13C2 00A0 0066      	move.b	d2,(Loop_EndSoundInit+1|Z80_RAM); 16 cycles
     213/     2B6 : E04A                	lsr.w	#8,d2							; 22 cycles
     214/     2B8 : 13C2 00A0 0068      	move.b	d2,(Loop_EndSoundInit+3|Z80_RAM); 16 cycles
     215/     2BE : 13FC 0001 FFFF 0004 	move.b	#1,shouldStop					; 16 cycles
     216/     2C6 : 6008                	bra.s	$$continue						; 10 cycles
     217/     2C8 :                     ; --- 82 cycles in total ---
     218/     2C8 :                     $$skip_tracking:
     219/     2C8 :                     	; Normal Z80 playback routine
     220/     2C8 : 13FC 0017 00A0 0060 	move.b	#Loop,(Z80RoutineAddress+2)|Z80_RAM	; Little endian, 16 cycles
     221/     2D0 :                     
     222/     2D0 :                     $$continue:
     223/     2D0 :                     ; --- 98 cycles in total ---
     224/     2D0 : 7004                	moveq	#4,d0	; 4 cycles
     225/     2D2 :                     $$timing_wait1:		; 54 cycles
     226/     2D2 : 51C8 FFFE           	dbf d0,$$timing_wait1
     227/     2D6 :                     ; --- 156 cycles in total ---
     228/     2D6 :                     
     229/     2D6 : (MACRO)[3]          	loadSamples	; D0 and D1 break here
     229/     2D6 :                             
     229/     2D6 : =$0                 i set 0
     229/     2D6 :                     
     229/     2D6 : 2018                        move.l  (a0)+,d0                ; 12 cycles
     229/     2D8 : 01C9 0000                   movep.l d0,(i+(8*0),a1) ; 24 cycles
     229/     2DC :                     
     229/     2DC : 2018                        move.l  (a0)+,d0
     229/     2DE : 01C9 0008                   movep.l d0,(i+(8*1),a1)
     229/     2E2 :                             ; 72 cycles in total
     229/     2E2 : =$8                 i set 8
     229/     2E2 :                     
     229/     2E2 :                             while i < 1072
     229/     2E2 :                     
     229/     2E2 :                             if smoothPlayback
     229/     2E2 :                                     move.b  (a2)+,(a3)
     229/     2E2 :                             elseif accurateSpeed
     229/     2E2 :                                     addq.l  #1,a2
     229/     2E2 :                                     nop
     229/     2E2 :                             endif
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*0),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*1),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*2),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*3),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*4),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*5),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                     
     229/     2E2 :                             if smoothPlayback
     229/     2E2 :                                     move.b  (a2)+,(a3)
     229/     2E2 :                             elseif accurateSpeed
     229/     2E2 :                                     addq.l  #1,a2
     229/     2E2 :                                     nop
     229/     2E2 :                             endif
     229/     2E2 :                     
     229/     2E2 :                             movep.l d0,(i+(8*6),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*7),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*8),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*9),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*10),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*11),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             move.l  (a0)+,d1
     229/     2E2 :                     
     229/     2E2 :                             if smoothPlayback
     229/     2E2 :                                     move.b  (a2)+,(a3)
     229/     2E2 :                             elseif accurateSpeed
     229/     2E2 :                                     addq.l  #1,a2
     229/     2E2 :                                     nop
     229/     2E2 :                             endif
     229/     2E2 :                     
     229/     2E2 :                             movep.l d0,(i+(8*12),a1)
     229/     2E2 :                             movep.l d1,(i+(8*13),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*14),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*15),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*16),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*17),a1)
     229/     2E2 :                     
     229/     2E2 :                             move.l  (a0)+,d0
     229/     2E2 :                             movep.l d0,(i+(8*18),a1)
     229/     2E2 :                     
     229/     2E2 :                     i set i + 152
     229/     2E2 :                             endm
     229/     2E2 :                     
     229/     2E2 : 169A                                move.b  (a2)+,(a3)
     229/     2E4 :                     
     229/     2E4 : 2018                        move.l  (a0)+,d0
     229/     2E6 : 01C9 0008                   movep.l d0,(i+(8*0),a1)
     229/     2EA :                     
     229/     2EA : 2018                        move.l  (a0)+,d0
     229/     2EC : 01C9 0010                   movep.l d0,(i+(8*1),a1)
     229/     2F0 :                     
     229/     2F0 : 2018                        move.l  (a0)+,d0
     229/     2F2 : 01C9 0018                   movep.l d0,(i+(8*2),a1)
     229/     2F6 :                     
     229/     2F6 : 2018                        move.l  (a0)+,d0
     229/     2F8 : 01C9 0020                   movep.l d0,(i+(8*3),a1)
     229/     2FC :                     
     229/     2FC : 2018                        move.l  (a0)+,d0
     229/     2FE : 01C9 0028                   movep.l d0,(i+(8*4),a1)
     229/     302 :                     
     229/     302 : 2018                        move.l  (a0)+,d0
     229/     304 : 01C9 0030                   movep.l d0,(i+(8*5),a1)
     229/     308 :                     
     229/     308 : 2018                        move.l  (a0)+,d0
     229/     30A :                     
     229/     30A : 169A                                move.b  (a2)+,(a3)
     229/     30C :                     
     229/     30C : 01C9 0038                   movep.l d0,(i+(8*6),a1)
     229/     310 :                     
     229/     310 : 2018                        move.l  (a0)+,d0
     229/     312 : 01C9 0040                   movep.l d0,(i+(8*7),a1)
     229/     316 :                     
     229/     316 : 2018                        move.l  (a0)+,d0
     229/     318 : 01C9 0048                   movep.l d0,(i+(8*8),a1)
     229/     31C :                     
     229/     31C : 2018                        move.l  (a0)+,d0
     229/     31E : 01C9 0050                   movep.l d0,(i+(8*9),a1)
     229/     322 :                     
     229/     322 : 2018                        move.l  (a0)+,d0
     229/     324 : 01C9 0058                   movep.l d0,(i+(8*10),a1)
     229/     328 :                     
     229/     328 : 2018                        move.l  (a0)+,d0
     229/     32A : 01C9 0060                   movep.l d0,(i+(8*11),a1)
     229/     32E :                     
     229/     32E : 2018                        move.l  (a0)+,d0
     229/     330 : 2218                        move.l  (a0)+,d1
     229/     332 :                     
     229/     332 : 169A                                move.b  (a2)+,(a3)
     229/     334 :                     
     229/     334 : 01C9 0068                   movep.l d0,(i+(8*12),a1)
     229/     338 : 03C9 0070                   movep.l d1,(i+(8*13),a1)
     229/     33C :                     
     229/     33C : 2018                        move.l  (a0)+,d0
     229/     33E : 01C9 0078                   movep.l d0,(i+(8*14),a1)
     229/     342 :                     
     229/     342 : 2018                        move.l  (a0)+,d0
     229/     344 : 01C9 0080                   movep.l d0,(i+(8*15),a1)
     229/     348 :                     
     229/     348 : 2018                        move.l  (a0)+,d0
     229/     34A : 01C9 0088                   movep.l d0,(i+(8*16),a1)
     229/     34E :                     
     229/     34E : 2018                        move.l  (a0)+,d0
     229/     350 : 01C9 0090                   movep.l d0,(i+(8*17),a1)
     229/     354 :                     
     229/     354 : 2018                        move.l  (a0)+,d0
     229/     356 : 01C9 0098                   movep.l d0,(i+(8*18),a1)
     229/     35A :                     
     229/     35A : =$A0                i set i + 152
     229/     35A :                     
     229/     35A : 169A                                move.b  (a2)+,(a3)
     229/     35C :                     
     229/     35C : 2018                        move.l  (a0)+,d0
     229/     35E : 01C9 00A0                   movep.l d0,(i+(8*0),a1)
     229/     362 :                     
     229/     362 : 2018                        move.l  (a0)+,d0
     229/     364 : 01C9 00A8                   movep.l d0,(i+(8*1),a1)
     229/     368 :                     
     229/     368 : 2018                        move.l  (a0)+,d0
     229/     36A : 01C9 00B0                   movep.l d0,(i+(8*2),a1)
     229/     36E :                     
     229/     36E : 2018                        move.l  (a0)+,d0
     229/     370 : 01C9 00B8                   movep.l d0,(i+(8*3),a1)
     229/     374 :                     
     229/     374 : 2018                        move.l  (a0)+,d0
     229/     376 : 01C9 00C0                   movep.l d0,(i+(8*4),a1)
     229/     37A :                     
     229/     37A : 2018                        move.l  (a0)+,d0
     229/     37C : 01C9 00C8                   movep.l d0,(i+(8*5),a1)
     229/     380 :                     
     229/     380 : 2018                        move.l  (a0)+,d0
     229/     382 :                     
     229/     382 : 169A                                move.b  (a2)+,(a3)
     229/     384 :                     
     229/     384 : 01C9 00D0                   movep.l d0,(i+(8*6),a1)
     229/     388 :                     
     229/     388 : 2018                        move.l  (a0)+,d0
     229/     38A : 01C9 00D8                   movep.l d0,(i+(8*7),a1)
     229/     38E :                     
     229/     38E : 2018                        move.l  (a0)+,d0
     229/     390 : 01C9 00E0                   movep.l d0,(i+(8*8),a1)
     229/     394 :                     
     229/     394 : 2018                        move.l  (a0)+,d0
     229/     396 : 01C9 00E8                   movep.l d0,(i+(8*9),a1)
     229/     39A :                     
     229/     39A : 2018                        move.l  (a0)+,d0
     229/     39C : 01C9 00F0                   movep.l d0,(i+(8*10),a1)
     229/     3A0 :                     
     229/     3A0 : 2018                        move.l  (a0)+,d0
     229/     3A2 : 01C9 00F8                   movep.l d0,(i+(8*11),a1)
     229/     3A6 :                     
     229/     3A6 : 2018                        move.l  (a0)+,d0
     229/     3A8 : 2218                        move.l  (a0)+,d1
     229/     3AA :                     
     229/     3AA : 169A                                move.b  (a2)+,(a3)
     229/     3AC :                     
     229/     3AC : 01C9 0100                   movep.l d0,(i+(8*12),a1)
     229/     3B0 : 03C9 0108                   movep.l d1,(i+(8*13),a1)
     229/     3B4 :                     
     229/     3B4 : 2018                        move.l  (a0)+,d0
     229/     3B6 : 01C9 0110                   movep.l d0,(i+(8*14),a1)
     229/     3BA :                     
     229/     3BA : 2018                        move.l  (a0)+,d0
     229/     3BC : 01C9 0118                   movep.l d0,(i+(8*15),a1)
     229/     3C0 :                     
     229/     3C0 : 2018                        move.l  (a0)+,d0
     229/     3C2 : 01C9 0120                   movep.l d0,(i+(8*16),a1)
     229/     3C6 :                     
     229/     3C6 : 2018                        move.l  (a0)+,d0
     229/     3C8 : 01C9 0128                   movep.l d0,(i+(8*17),a1)
     229/     3CC :                     
     229/     3CC : 2018                        move.l  (a0)+,d0
     229/     3CE : 01C9 0130                   movep.l d0,(i+(8*18),a1)
     229/     3D2 :                     
     229/     3D2 : =$138               i set i + 152
     229/     3D2 :                     
     229/     3D2 : 169A                                move.b  (a2)+,(a3)
     229/     3D4 :                     
     229/     3D4 : 2018                        move.l  (a0)+,d0
     229/     3D6 : 01C9 0138                   movep.l d0,(i+(8*0),a1)
     229/     3DA :                     
     229/     3DA : 2018                        move.l  (a0)+,d0
     229/     3DC : 01C9 0140                   movep.l d0,(i+(8*1),a1)
     229/     3E0 :                     
     229/     3E0 : 2018                        move.l  (a0)+,d0
     229/     3E2 : 01C9 0148                   movep.l d0,(i+(8*2),a1)
     229/     3E6 :                     
     229/     3E6 : 2018                        move.l  (a0)+,d0
     229/     3E8 : 01C9 0150                   movep.l d0,(i+(8*3),a1)
     229/     3EC :                     
     229/     3EC : 2018                        move.l  (a0)+,d0
     229/     3EE : 01C9 0158                   movep.l d0,(i+(8*4),a1)
     229/     3F2 :                     
     229/     3F2 : 2018                        move.l  (a0)+,d0
     229/     3F4 : 01C9 0160                   movep.l d0,(i+(8*5),a1)
     229/     3F8 :                     
     229/     3F8 : 2018                        move.l  (a0)+,d0
     229/     3FA :                     
     229/     3FA : 169A                                move.b  (a2)+,(a3)
     229/     3FC :                     
     229/     3FC : 01C9 0168                   movep.l d0,(i+(8*6),a1)
     229/     400 :                     
     229/     400 : 2018                        move.l  (a0)+,d0
     229/     402 : 01C9 0170                   movep.l d0,(i+(8*7),a1)
     229/     406 :                     
     229/     406 : 2018                        move.l  (a0)+,d0
     229/     408 : 01C9 0178                   movep.l d0,(i+(8*8),a1)
     229/     40C :                     
     229/     40C : 2018                        move.l  (a0)+,d0
     229/     40E : 01C9 0180                   movep.l d0,(i+(8*9),a1)
     229/     412 :                     
     229/     412 : 2018                        move.l  (a0)+,d0
     229/     414 : 01C9 0188                   movep.l d0,(i+(8*10),a1)
     229/     418 :                     
     229/     418 : 2018                        move.l  (a0)+,d0
     229/     41A : 01C9 0190                   movep.l d0,(i+(8*11),a1)
     229/     41E :                     
     229/     41E : 2018                        move.l  (a0)+,d0
     229/     420 : 2218                        move.l  (a0)+,d1
     229/     422 :                     
     229/     422 : 169A                                move.b  (a2)+,(a3)
     229/     424 :                     
     229/     424 : 01C9 0198                   movep.l d0,(i+(8*12),a1)
     229/     428 : 03C9 01A0                   movep.l d1,(i+(8*13),a1)
     229/     42C :                     
     229/     42C : 2018                        move.l  (a0)+,d0
     229/     42E : 01C9 01A8                   movep.l d0,(i+(8*14),a1)
     229/     432 :                     
     229/     432 : 2018                        move.l  (a0)+,d0
     229/     434 : 01C9 01B0                   movep.l d0,(i+(8*15),a1)
     229/     438 :                     
     229/     438 : 2018                        move.l  (a0)+,d0
     229/     43A : 01C9 01B8                   movep.l d0,(i+(8*16),a1)
     229/     43E :                     
     229/     43E : 2018                        move.l  (a0)+,d0
     229/     440 : 01C9 01C0                   movep.l d0,(i+(8*17),a1)
     229/     444 :                     
     229/     444 : 2018                        move.l  (a0)+,d0
     229/     446 : 01C9 01C8                   movep.l d0,(i+(8*18),a1)
     229/     44A :                     
     229/     44A : =$1D0               i set i + 152
     229/     44A :                     
     229/     44A : 169A                                move.b  (a2)+,(a3)
     229/     44C :                     
     229/     44C : 2018                        move.l  (a0)+,d0
     229/     44E : 01C9 01D0                   movep.l d0,(i+(8*0),a1)
     229/     452 :                     
     229/     452 : 2018                        move.l  (a0)+,d0
     229/     454 : 01C9 01D8                   movep.l d0,(i+(8*1),a1)
     229/     458 :                     
     229/     458 : 2018                        move.l  (a0)+,d0
     229/     45A : 01C9 01E0                   movep.l d0,(i+(8*2),a1)
     229/     45E :                     
     229/     45E : 2018                        move.l  (a0)+,d0
     229/     460 : 01C9 01E8                   movep.l d0,(i+(8*3),a1)
     229/     464 :                     
     229/     464 : 2018                        move.l  (a0)+,d0
     229/     466 : 01C9 01F0                   movep.l d0,(i+(8*4),a1)
     229/     46A :                     
     229/     46A : 2018                        move.l  (a0)+,d0
     229/     46C : 01C9 01F8                   movep.l d0,(i+(8*5),a1)
     229/     470 :                     
     229/     470 : 2018                        move.l  (a0)+,d0
     229/     472 :                     
     229/     472 : 169A                                move.b  (a2)+,(a3)
     229/     474 :                     
     229/     474 : 01C9 0200                   movep.l d0,(i+(8*6),a1)
     229/     478 :                     
     229/     478 : 2018                        move.l  (a0)+,d0
     229/     47A : 01C9 0208                   movep.l d0,(i+(8*7),a1)
     229/     47E :                     
     229/     47E : 2018                        move.l  (a0)+,d0
     229/     480 : 01C9 0210                   movep.l d0,(i+(8*8),a1)
     229/     484 :                     
     229/     484 : 2018                        move.l  (a0)+,d0
     229/     486 : 01C9 0218                   movep.l d0,(i+(8*9),a1)
     229/     48A :                     
     229/     48A : 2018                        move.l  (a0)+,d0
     229/     48C : 01C9 0220                   movep.l d0,(i+(8*10),a1)
     229/     490 :                     
     229/     490 : 2018                        move.l  (a0)+,d0
     229/     492 : 01C9 0228                   movep.l d0,(i+(8*11),a1)
     229/     496 :                     
     229/     496 : 2018                        move.l  (a0)+,d0
     229/     498 : 2218                        move.l  (a0)+,d1
     229/     49A :                     
     229/     49A : 169A                                move.b  (a2)+,(a3)
     229/     49C :                     
     229/     49C : 01C9 0230                   movep.l d0,(i+(8*12),a1)
     229/     4A0 : 03C9 0238                   movep.l d1,(i+(8*13),a1)
     229/     4A4 :                     
     229/     4A4 : 2018                        move.l  (a0)+,d0
     229/     4A6 : 01C9 0240                   movep.l d0,(i+(8*14),a1)
     229/     4AA :                     
     229/     4AA : 2018                        move.l  (a0)+,d0
     229/     4AC : 01C9 0248                   movep.l d0,(i+(8*15),a1)
     229/     4B0 :                     
     229/     4B0 : 2018                        move.l  (a0)+,d0
     229/     4B2 : 01C9 0250                   movep.l d0,(i+(8*16),a1)
     229/     4B6 :                     
     229/     4B6 : 2018                        move.l  (a0)+,d0
     229/     4B8 : 01C9 0258                   movep.l d0,(i+(8*17),a1)
     229/     4BC :                     
     229/     4BC : 2018                        move.l  (a0)+,d0
     229/     4BE : 01C9 0260                   movep.l d0,(i+(8*18),a1)
     229/     4C2 :                     
     229/     4C2 : =$268               i set i + 152
     229/     4C2 :                     
     229/     4C2 : 169A                                move.b  (a2)+,(a3)
     229/     4C4 :                     
     229/     4C4 : 2018                        move.l  (a0)+,d0
     229/     4C6 : 01C9 0268                   movep.l d0,(i+(8*0),a1)
     229/     4CA :                     
     229/     4CA : 2018                        move.l  (a0)+,d0
     229/     4CC : 01C9 0270                   movep.l d0,(i+(8*1),a1)
     229/     4D0 :                     
     229/     4D0 : 2018                        move.l  (a0)+,d0
     229/     4D2 : 01C9 0278                   movep.l d0,(i+(8*2),a1)
     229/     4D6 :                     
     229/     4D6 : 2018                        move.l  (a0)+,d0
     229/     4D8 : 01C9 0280                   movep.l d0,(i+(8*3),a1)
     229/     4DC :                     
     229/     4DC : 2018                        move.l  (a0)+,d0
     229/     4DE : 01C9 0288                   movep.l d0,(i+(8*4),a1)
     229/     4E2 :                     
     229/     4E2 : 2018                        move.l  (a0)+,d0
     229/     4E4 : 01C9 0290                   movep.l d0,(i+(8*5),a1)
     229/     4E8 :                     
     229/     4E8 : 2018                        move.l  (a0)+,d0
     229/     4EA :                     
     229/     4EA : 169A                                move.b  (a2)+,(a3)
     229/     4EC :                     
     229/     4EC : 01C9 0298                   movep.l d0,(i+(8*6),a1)
     229/     4F0 :                     
     229/     4F0 : 2018                        move.l  (a0)+,d0
     229/     4F2 : 01C9 02A0                   movep.l d0,(i+(8*7),a1)
     229/     4F6 :                     
     229/     4F6 : 2018                        move.l  (a0)+,d0
     229/     4F8 : 01C9 02A8                   movep.l d0,(i+(8*8),a1)
     229/     4FC :                     
     229/     4FC : 2018                        move.l  (a0)+,d0
     229/     4FE : 01C9 02B0                   movep.l d0,(i+(8*9),a1)
     229/     502 :                     
     229/     502 : 2018                        move.l  (a0)+,d0
     229/     504 : 01C9 02B8                   movep.l d0,(i+(8*10),a1)
     229/     508 :                     
     229/     508 : 2018                        move.l  (a0)+,d0
     229/     50A : 01C9 02C0                   movep.l d0,(i+(8*11),a1)
     229/     50E :                     
     229/     50E : 2018                        move.l  (a0)+,d0
     229/     510 : 2218                        move.l  (a0)+,d1
     229/     512 :                     
     229/     512 : 169A                                move.b  (a2)+,(a3)
     229/     514 :                     
     229/     514 : 01C9 02C8                   movep.l d0,(i+(8*12),a1)
     229/     518 : 03C9 02D0                   movep.l d1,(i+(8*13),a1)
     229/     51C :                     
     229/     51C : 2018                        move.l  (a0)+,d0
     229/     51E : 01C9 02D8                   movep.l d0,(i+(8*14),a1)
     229/     522 :                     
     229/     522 : 2018                        move.l  (a0)+,d0
     229/     524 : 01C9 02E0                   movep.l d0,(i+(8*15),a1)
     229/     528 :                     
     229/     528 : 2018                        move.l  (a0)+,d0
     229/     52A : 01C9 02E8                   movep.l d0,(i+(8*16),a1)
     229/     52E :                     
     229/     52E : 2018                        move.l  (a0)+,d0
     229/     530 : 01C9 02F0                   movep.l d0,(i+(8*17),a1)
     229/     534 :                     
     229/     534 : 2018                        move.l  (a0)+,d0
     229/     536 : 01C9 02F8                   movep.l d0,(i+(8*18),a1)
     229/     53A :                     
     229/     53A : =$300               i set i + 152
     229/     53A :                     
     229/     53A : 169A                                move.b  (a2)+,(a3)
     229/     53C :                     
     229/     53C : 2018                        move.l  (a0)+,d0
     229/     53E : 01C9 0300                   movep.l d0,(i+(8*0),a1)
     229/     542 :                     
     229/     542 : 2018                        move.l  (a0)+,d0
     229/     544 : 01C9 0308                   movep.l d0,(i+(8*1),a1)
     229/     548 :                     
     229/     548 : 2018                        move.l  (a0)+,d0
     229/     54A : 01C9 0310                   movep.l d0,(i+(8*2),a1)
     229/     54E :                     
     229/     54E : 2018                        move.l  (a0)+,d0
     229/     550 : 01C9 0318                   movep.l d0,(i+(8*3),a1)
     229/     554 :                     
     229/     554 : 2018                        move.l  (a0)+,d0
     229/     556 : 01C9 0320                   movep.l d0,(i+(8*4),a1)
     229/     55A :                     
     229/     55A : 2018                        move.l  (a0)+,d0
     229/     55C : 01C9 0328                   movep.l d0,(i+(8*5),a1)
     229/     560 :                     
     229/     560 : 2018                        move.l  (a0)+,d0
     229/     562 :                     
     229/     562 : 169A                                move.b  (a2)+,(a3)
     229/     564 :                     
     229/     564 : 01C9 0330                   movep.l d0,(i+(8*6),a1)
     229/     568 :                     
     229/     568 : 2018                        move.l  (a0)+,d0
     229/     56A : 01C9 0338                   movep.l d0,(i+(8*7),a1)
     229/     56E :                     
     229/     56E : 2018                        move.l  (a0)+,d0
     229/     570 : 01C9 0340                   movep.l d0,(i+(8*8),a1)
     229/     574 :                     
     229/     574 : 2018                        move.l  (a0)+,d0
     229/     576 : 01C9 0348                   movep.l d0,(i+(8*9),a1)
     229/     57A :                     
     229/     57A : 2018                        move.l  (a0)+,d0
     229/     57C : 01C9 0350                   movep.l d0,(i+(8*10),a1)
     229/     580 :                     
     229/     580 : 2018                        move.l  (a0)+,d0
     229/     582 : 01C9 0358                   movep.l d0,(i+(8*11),a1)
     229/     586 :                     
     229/     586 : 2018                        move.l  (a0)+,d0
     229/     588 : 2218                        move.l  (a0)+,d1
     229/     58A :                     
     229/     58A : 169A                                move.b  (a2)+,(a3)
     229/     58C :                     
     229/     58C : 01C9 0360                   movep.l d0,(i+(8*12),a1)
     229/     590 : 03C9 0368                   movep.l d1,(i+(8*13),a1)
     229/     594 :                     
     229/     594 : 2018                        move.l  (a0)+,d0
     229/     596 : 01C9 0370                   movep.l d0,(i+(8*14),a1)
     229/     59A :                     
     229/     59A : 2018                        move.l  (a0)+,d0
     229/     59C : 01C9 0378                   movep.l d0,(i+(8*15),a1)
     229/     5A0 :                     
     229/     5A0 : 2018                        move.l  (a0)+,d0
     229/     5A2 : 01C9 0380                   movep.l d0,(i+(8*16),a1)
     229/     5A6 :                     
     229/     5A6 : 2018                        move.l  (a0)+,d0
     229/     5A8 : 01C9 0388                   movep.l d0,(i+(8*17),a1)
     229/     5AC :                     
     229/     5AC : 2018                        move.l  (a0)+,d0
     229/     5AE : 01C9 0390                   movep.l d0,(i+(8*18),a1)
     229/     5B2 :                     
     229/     5B2 : =$398               i set i + 152
     229/     5B2 :                     
     229/     5B2 : 169A                                move.b  (a2)+,(a3)
     229/     5B4 :                     
     229/     5B4 : 2018                        move.l  (a0)+,d0
     229/     5B6 : 01C9 0398                   movep.l d0,(i+(8*0),a1)
     229/     5BA :                     
     229/     5BA : 2018                        move.l  (a0)+,d0
     229/     5BC : 01C9 03A0                   movep.l d0,(i+(8*1),a1)
     229/     5C0 :                     
     229/     5C0 : 2018                        move.l  (a0)+,d0
     229/     5C2 : 01C9 03A8                   movep.l d0,(i+(8*2),a1)
     229/     5C6 :                     
     229/     5C6 : 2018                        move.l  (a0)+,d0
     229/     5C8 : 01C9 03B0                   movep.l d0,(i+(8*3),a1)
     229/     5CC :                     
     229/     5CC : 2018                        move.l  (a0)+,d0
     229/     5CE : 01C9 03B8                   movep.l d0,(i+(8*4),a1)
     229/     5D2 :                     
     229/     5D2 : 2018                        move.l  (a0)+,d0
     229/     5D4 : 01C9 03C0                   movep.l d0,(i+(8*5),a1)
     229/     5D8 :                     
     229/     5D8 : 2018                        move.l  (a0)+,d0
     229/     5DA :                     
     229/     5DA : 169A                                move.b  (a2)+,(a3)
     229/     5DC :                     
     229/     5DC : 01C9 03C8                   movep.l d0,(i+(8*6),a1)
     229/     5E0 :                     
     229/     5E0 : 2018                        move.l  (a0)+,d0
     229/     5E2 : 01C9 03D0                   movep.l d0,(i+(8*7),a1)
     229/     5E6 :                     
     229/     5E6 : 2018                        move.l  (a0)+,d0
     229/     5E8 : 01C9 03D8                   movep.l d0,(i+(8*8),a1)
     229/     5EC :                     
     229/     5EC : 2018                        move.l  (a0)+,d0
     229/     5EE : 01C9 03E0                   movep.l d0,(i+(8*9),a1)
     229/     5F2 :                     
     229/     5F2 : 2018                        move.l  (a0)+,d0
     229/     5F4 : 01C9 03E8                   movep.l d0,(i+(8*10),a1)
     229/     5F8 :                     
     229/     5F8 : 2018                        move.l  (a0)+,d0
     229/     5FA : 01C9 03F0                   movep.l d0,(i+(8*11),a1)
     229/     5FE :                     
     229/     5FE : 2018                        move.l  (a0)+,d0
     229/     600 : 2218                        move.l  (a0)+,d1
     229/     602 :                     
     229/     602 : 169A                                move.b  (a2)+,(a3)
     229/     604 :                     
     229/     604 : 01C9 03F8                   movep.l d0,(i+(8*12),a1)
     229/     608 : 03C9 0400                   movep.l d1,(i+(8*13),a1)
     229/     60C :                     
     229/     60C : 2018                        move.l  (a0)+,d0
     229/     60E : 01C9 0408                   movep.l d0,(i+(8*14),a1)
     229/     612 :                     
     229/     612 : 2018                        move.l  (a0)+,d0
     229/     614 : 01C9 0410                   movep.l d0,(i+(8*15),a1)
     229/     618 :                     
     229/     618 : 2018                        move.l  (a0)+,d0
     229/     61A : 01C9 0418                   movep.l d0,(i+(8*16),a1)
     229/     61E :                     
     229/     61E : 2018                        move.l  (a0)+,d0
     229/     620 : 01C9 0420                   movep.l d0,(i+(8*17),a1)
     229/     624 :                     
     229/     624 : 2018                        move.l  (a0)+,d0
     229/     626 : 01C9 0428                   movep.l d0,(i+(8*18),a1)
     229/     62A :                     
     229/     62A : =$430               i set i + 152
     229/     62A :                     
     230/     62A :                     
     232/     62A : 169A                		move.b	(a2)+,(a3)	; Output sample, 12 cycles
     237/     62C :                     
     238/     62C :                     ; --- Cycle count restarts ---
     239/     62C : 13FC 0050 00A0 004E 	move.b	#Wait68k.continue,((Wait68k+1)|Z80_RAM)	; 20 cycles
     240/     634 : 23C2 FFFF 0000      	move.l	d2,(sampleIndex)	; 20 cycles
     241/     63A :                     
     242/     63A : 7007                	moveq	#7,d0
     243/     63C :                     $$timing_wait2:
     244/     63C : 51C8 FFFE           	dbf	d0,$$timing_wait2
     245/     640 :                     
     246/     640 : (MACRO)[12]         	startZ80 a5	; Restart Z80
     246/     640 :                     
     246/     640 : 3ABC 0000                                   move.w  #0,(a5)
     247/     644 :                     
     248/     644 :                     	; DPLC loading queues
     249/     644 : 4E73                	rte
     250/     646 :                     
     251/     646 :                     
     252/     646 :                     EntryPoint:
     253/     646 : 41F9 00C0 0004      	lea		VDP_CTRL,a0
     254/     64C :                     
     255/     64C :                     ; VDP register setup
     256/     64C : 20BC 8004 8124      	move.l  #(VDPREG_MODE1|%00000100)<<16|VDPREG_MODE2|%00100100,(a0)	; Mode register #1 and Mode register #2
     257/     652 : 20BC 8B00 8C81      	move.l  #(VDPREG_MODE3|%00000000)<<16|VDPREG_MODE4|%10000001,(a0)	; Mode register #3 and Mode register #4
     258/     658 :                     	
     259/     658 : 20BC 823F 8407      	move.l  #(VDPREG_PLANEA|(PLANEA_ADDR>>10))<<16|VDPREG_PLANEB|(PLANEB_ADDR>>13),(a0)	; Plane A and Plane B address
     260/     65E : 20BC 857F 833F      	move.l  #(VDPREG_SPRITE|(SPRITE_ADDR>>9))<<16|VDPREG_WINDOW|(WINDOW_ADDR>>10),(a0)	; Sprite and Window address
     261/     664 : 30BC 8D3F               move.w  #VDPREG_HSCROLL|(HSCROLL_ADDR>>10),(a0)										; HScroll address
     262/     668 :                         
     263/     668 : 20BC 9000 9100          move.l  #(VDPREG_SIZE|$00)<<16|VDPREG_WINX|$00,(a0)		; Tilemap size and Window X split
     264/     66E : 20BC 9200 8F00          move.l  #(VDPREG_WINY|$00)<<16|VDPREG_INCR|$00,(a0)		; Window Y split and Autoincrement
     265/     674 : 20BC 8700 8AFF          move.l  #(VDPREG_BGCOL|$00)<<16|VDPREG_HRATE|$FF,(a0)	; Background color and HBlank IRQ rate
     266/     67A :                     
     267/     67A :                     ; Start of ROM code
     268/     67A :                     
     269/     67A : 47F9 00A1 1100      	lea Z80_BUSREQ,a3
     270/     680 : 45F9 00A1 1200      	lea Z80_RESET,a2
     271/     686 :                     
     272/     686 : 343C 0100           	move.w	#$100,d2	; Assert, stop
     273/     68A : 7200                	moveq	#0,d1		; Deassert, start
     274/     68C :                     
     275/     68C : (MACRO)[13]         	assertZ80Reset d1,a2	; Assert reset
     275/     68C :                     
     275/     68C : 3481                                        move.w  d1,(a2)
     276/     68E : (MACRO)[14]         	stopZ80 d2,a3			; Request bus
     276/     68E :                     
     276/     68E : 3682                                        move.w  d2,(a3)
     277/     690 : (MACRO)[15]         	deassertZ80Reset d2,a2	; Release reset
     277/     690 :                     
     277/     690 : 3482                                        move.w  d2,(a2)
     278/     692 :                     
     279/     692 :                     ; We can do more stuff while the Z80 is theoretically stopping
     280/     692 : 41F8 06E0           	lea Z80RomStart,a0
     281/     696 : 43F9 00A0 0000      	lea Z80_RAM,a1
     282/     69C : 23FC 0000 0770 FFFF 	move.l 	#Music,(sampleIndex)
              6A4 : 0000               
     283/     6A6 : 303C 008F           	move.w	#(Z80RomEnd-Z80RomStart)-1,d0	; Mustn't go over $7F
     284/     6AA :                     
     285/     6AA :                     $$copy_program:
     286/     6AA : 12D8                	move.b	(a0)+,(a1)+
     287/     6AC : 51C8 FFFC           	dbf d0,$$copy_program
     288/     6B0 :                     
     289/     6B0 : 4239 00A0 1000      	clr.b	(playedSamplesHigh|Z80_RAM)
     290/     6B6 : 4239 00A0 1002      	clr.b	(playedSamplesLow|Z80_RAM)
     291/     6BC : 4239 FFFF 0004      	clr.b	(shouldStop)
     292/     6C2 :                     
     293/     6C2 : (MACRO)[16]         	assertZ80Reset d2,a2	; Assert reset
     293/     6C2 :                     
     293/     6C2 : 3482                                        move.w  d2,(a2)
     294/     6C4 :                     
     295/     6C4 : 7014                	moveq	#20,d0
     296/     6C6 :                     $$wait:	; Wait for the YM2612
     297/     6C6 : 51C8 FFFE               dbf	d0,$$wait
     298/     6CA :                     
     299/     6CA : (MACRO)[17]         	deassertZ80Reset d2,a2	; Release reset
     299/     6CA :                     
     299/     6CA : 3482                                        move.w  d2,(a2)
     300/     6CC :                     
     301/     6CC :                     	;loopTest 53
     302/     6CC :                     
     303/     6CC : (MACRO)[18]         	startZ80 d1,a3			; Release bus
     303/     6CC :                     
     303/     6CC : 3681                                        move.w  d1,(a3)
     304/     6CE :                     
     305/     6CE :                     HaltCPU:
     306/     6CE : 4A39 FFFF 0004      	tst.b	shouldStop
     307/     6D4 : 6606                	bne.s	$$disableCPU
     308/     6D6 : 4E72 2500           	stop	#$2500
     309/     6DA : 60F2                	bra.s	HaltCPU
     310/     6DC :                     $$disableCPU:
     311/     6DC : 4E72 2700           	stop	#$2700
     312/     6E0 :                     
     313/     6E0 :                     	include "Driver.z80"
(1)    1/ 6E0 :                         	cpu Z80
(1)    2/ 6E0 :                         Z80RomStart
(1)    3/ 6E0 :                         
(1)    4/   0 :                             phase 0	; Set label addresses to the start of the Z80 RAM
(1)    5/   0 :                         
(1)    6/   0 : 11 90 00                	ld	de,SampleBuffer
(1)    7/   3 :                         
(1)    8/   3 : 31 00 20                	ld	sp,2000h	; Align stack pointer correctly
(1)    9/   6 :                         
(1)   10/   6 : 01 00 40                	ld	bc,4000h	; YM2612 bank 1 port
(1)   11/   9 : 21 01 40                	ld	hl,4001h	; YM2612 data port
(1)   12/   C : 3E 2B                   	ld	a,DAC_ENABLE; DAC enable address
(1)   13/   E : 02                      	ld	(bc),a		; Switch to DAC enable register
(1)   14/   F : 36 80                   	ld	(hl),80h	; Enable DAC
(1)   15/  11 : 3D                      	dec	a			; Now a is 2Ah (DAC_IN)
(1)   16/  12 : 02                      	ld	(bc),a		; Switch to DAC data input
(1)   17/  13 :                         
(1)   18/  13 : ED 56                   	im	1
(1)   19/  15 : FB                      	ei
(1)   20/  16 : 76                      	halt		; Wait until next frame
(1)   21/  17 :                         
(1)   22/  17 :                         Loop:
(1)   23/  17 : 1A                      	ld	a,(de)
(1)   24/  18 : 77                      	ld	(hl),a
(1)   25/  19 : 1C                      	inc	e
(1)   26/  1A : 13                      	inc de
(1)   27/  1B :                         	rept 20
(1)   28/  1B :                         	nop			; Interrupt usually occurs here
(1)   29/  1B :                         	endm
(1)   28/  1B : 00                      	nop			; Interrupt usually occurs here
(1)   28/  1C : 00                      	nop			; Interrupt usually occurs here
(1)   28/  1D : 00                      	nop			; Interrupt usually occurs here
(1)   28/  1E : 00                      	nop			; Interrupt usually occurs here
(1)   28/  1F : 00                      	nop			; Interrupt usually occurs here
(1)   28/  20 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  21 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  22 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  23 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  24 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  25 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  26 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  27 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  28 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  29 : 00                      	nop			; Interrupt usually occurs here
(1)   28/  2A : 00                      	nop			; Interrupt usually occurs here
(1)   28/  2B : 00                      	nop			; Interrupt usually occurs here
(1)   28/  2C : 00                      	nop			; Interrupt usually occurs here
(1)   28/  2D : 00                      	nop			; Interrupt usually occurs here
(1)   28/  2E : 00                      	nop			; Interrupt usually occurs here
(1)   30/  2F : FD E9                   	jp	(iy)
(1)   31/  31 :                         
(1)   32/  38 :                         	rorg 38h - $
(1)   33/  38 :                         $$VDP_VBlank:
(1)   34/  38 : 1A                      	ld	a,(de)
(1)   35/  39 : 77                      	ld	(hl),a
(1)   36/  3A :                         
(1)   37/  3A :                         	; Subtract 0090h from DE
(1)   38/  3A : 7B                      	ld	a,e
(1)   39/  3B : D6 88                   	sub	SampleBuffer-8
(1)   40/  3D : 5F                      	ld	e,a
(1)   41/  3E : 7A                      	ld	a,d
(1)   42/  3F : DE 00                   	sbc	00h
(1)   43/  41 : 57                      	ld	d,a
(1)   44/  42 :                         
(1)   45/  42 :                         	; Now DE >> 1 (true 16-bit shift)
(1)   46/  42 : CB 1A                   	rr	d     ; shift high, MSB gets carry
(1)   47/  44 : CB 1B                   	rr	e     ; shift low, MSB gets old B LSB
(1)   48/  46 :                         
(1)   49/  46 :                         	; DE is how many samples the Z80 played
(1)   50/  46 : 21 00 10                	ld	hl,playedSamplesHigh
(1)   51/  49 : 72                      	ld	(hl),d	; High byte
(1)   52/  4A : 2C                      	inc l
(1)   53/  4B : 2C                      	inc l
(1)   54/  4C : 73                      	ld	(hl),e	; Low byte
(1)   55/  4D :                         Wait68k:
(1)   56/  4D : C3 4D 00                	jp	$
(1)   57/  50 :                         .continue:
(1)   58/  50 : 3E 4D                   	ld	a,Wait68k
(1)   59/  52 : 32 4E 00                	ld	(Wait68k+1),a	; Close the infinite loop
(1)   60/  55 : 11 90 00                	ld	de,SampleBuffer	; Reset DE
(1)   61/  58 : 21 01 40                	ld	hl,4001h		; Reset HL
(1)   62/  5B : 31 00 20                	ld	sp,2000h		; Reset SP
(1)   63/  5E :                         Z80RoutineAddress:
(1)   64/  5E : FD 21 00 00             	ld	iy,0000h
(1)   65/  62 : FB                      	ei
(1)   66/  63 : FD E9                   	jp	(iy)
(1)   67/  65 :                         
(1)   68/  65 :                         Loop_EndSoundInit:
(1)   69/  65 : 0E 00                   	ld	c,00h	; Second byte
(1)   70/  67 : 06 00                   	ld	b,00h	; First byte
(1)   71/  69 :                         $$loop_endSound1:
(1)   72/  69 : 1A                      	ld	a,(de)
(1)   73/  6A : 77                      	ld	(hl),a
(1)   74/  6B :                         	rept 16
(1)   75/  6B :                         	nop
(1)   76/  6B :                         	endm
(1)   75/  6B : 00                      	nop
(1)   75/  6C : 00                      	nop
(1)   75/  6D : 00                      	nop
(1)   75/  6E : 00                      	nop
(1)   75/  6F : 00                      	nop
(1)   75/  70 : 00                      	nop
(1)   75/  71 : 00                      	nop
(1)   75/  72 : 00                      	nop
(1)   75/  73 : 00                      	nop
(1)   75/  74 : 00                      	nop
(1)   75/  75 : 00                      	nop
(1)   75/  76 : 00                      	nop
(1)   75/  77 : 00                      	nop
(1)   75/  78 : 00                      	nop
(1)   75/  79 : 00                      	nop
(1)   75/  7A : 00                      	nop
(1)   77/  7B : 1C                      	inc	e
(1)   78/  7C : 13                      	inc de
(1)   79/  7D : 0B                      	dec	bc
(1)   80/  7E : 78                      	ld	a,b
(1)   81/  7F : B1                      	or	c
(1)   82/  80 : C2 69 00                	jp	nz,$$loop_endSound1
(1)   83/  83 :                         
(1)   84/  83 :                         Loop_NoDAC:
(1)   85/  83 : F3                      	di
(1)   86/  84 : 76                      	halt
(1)   87/  85 :                         
(1)   88/  90 :                         	rorg 90h - $
(1)   89/  90 :                         SampleBuffer
(1)   90/  90 :                         	; Where the 68k buffers samples
(1)   91/ 770 :                             dephase	; The rest of the labels are mapped normally
(1)   92/ 770 :                         
(1)   93/     770 :                     	cpu 68000
(1)   94/     770 :                     
(1)   95/     770 :                     Z80RomEnd
     314/     770 :                     
     315/     770 :                     Music:
     316/     770 :                     	;binclude "continuity_test.bin" ; Test with increasing bytes to make sure no samples get skipped
     317/     770 :                     	;binclude "24. Time Rift Shift ~ Vs. Metal Sonic.raw" ; Great music right here
     318/     770 :                     	binclude "Don't Stand So Close To Me.raw" ; Another banger
     319/  3FB308 :                     	;binclude "music.pcm" ; Let's not talk about this
     320/  3FB308 :                     	;binclude "My Summary.raw"
     321/  3FB308 :                     
     322/  3FB308 :                     RomEnd
 AS V1.42 Beta [Bld 298] - Source File Sonic.68k - Page 3 - 12/17/2025 22:12:31


  Symbol Table (* = unused):
  --------------------------

*ARCHITECTURE :                                        "i386-unknown-win32" - |
 AddressError :                 206 C |  BusError :                     200 C |
*CASESENSITIVE :                  1 - |  CHKException :                 218 C |
*CONSTPI :        3.141592653589793 - | *CRAM :                    C0000000 - |
*CRAM_DMA_CMD :            C0000080 - | *CRAM_SIZE :                     80 - |
 DAC_ENABLE :                    2B - | *DAC_IN :                        2A - |
*DATE :                "12/17/2025" - |  DivisionByZero :               212 C |
 EntryPoint :                   646 C | *FALSE :                          0 - |
*FLOATMAX :      1.797693134866E308 - | *FULLPMMU :                       1 - |
 GenericError :                 242 C | *HAS64 :                          1 - |
*HASFPU :                         0 - | *HASPMMU :                        0 - |
*HFLIP :                        800 - | *HIPRI :                       8000 - |
 HSCROLL_ADDR :                FFFF - | *HVFLIP :                      1800 - |
 HaltCPU :                      6CE C | *INSUPMODE :                      1 - |
*INTWIDTH :                      40 - |  IllegalInstruction :           20C C |
*JOY_B :                          4 - | *JOY_C :                          5 - |
*JOY_CTRL :                  A10009 - | *JOY_D :                          1 - |
*JOY_DATA :                  A10003 - | *JOY_L :                          2 - |
*JOY_R :                          3 - | *JOY_U :                          0 - |
*LISTON :                         3 - | *LOPRI :                          0 - |
 LineAEmulator :                230 C |  LineFEmulator :                236 C |
 Loop :                          17 C |  Loop_EndSoundInit :             65 C |
*Loop_NoDAC :                    83 C | *MACEXP :                         7 - |
*MOMCPU :                     68000 - |  MOMCPUNAME :               "68000" - |
 Music :                        770 C | *NESTMAX :                      100 - |
*NOFLIP :                         0 - | *PADDING :                        1 - |
*PAL0 :                           0 - | *PAL1 :                        2000 - |
*PAL2 :                        4000 - | *PAL3 :                        6000 - |
*PAT_BodyFont_SIZE_B :          C00 - | *PAT_BodyFont_SIZE_T :           60 - |
 PLANEA_ADDR :                 FFFF - |  PLANEB_ADDR :                 FFFF - |
 PrivilegeViolation :           224 C | *RELAXED :                        0 - |
 RomEnd :                    3FB308 C |  RomStart :                       0 C |
 SPRITE_ADDR :                 FFFF - |  SYS_STACK :                 FF0000 - |
 SampleBuffer :                  90 C |  SpuriousException :            23C C |
*TIME :                  "22:12:31" - |  TRACEException :               22A C |
 TRAPVException :               21E C |  TRUE :                           1 - |
 VDPREG_BGCOL :                8700 - | *VDPREG_DMALEN_H :             9400 - |
*VDPREG_DMALEN_L :             9300 - | *VDPREG_DMASRC_H :             9700 - |
*VDPREG_DMASRC_L :             9500 - | *VDPREG_DMASRC_M :             9600 - |
 VDPREG_HRATE :                8A00 - |  VDPREG_HSCROLL :              8D00 - |
 VDPREG_INCR :                 8F00 - |  VDPREG_MODE1 :                8000 - |
 VDPREG_MODE2 :                8100 - |  VDPREG_MODE3 :                8B00 - |
 VDPREG_MODE4 :                8C00 - |  VDPREG_PLANEA :               8200 - |
 VDPREG_PLANEB :               8400 - |  VDPREG_SIZE :                 9000 - |
 VDPREG_SPRITE :               8500 - |  VDPREG_WINDOW :               8300 - |
 VDPREG_WINX :                 9100 - |  VDPREG_WINY :                 9200 - |
 VDP_CTRL :                  C00004 - | *VDP_DATA :                  C00000 - |
*VDP_HVCOUNTER :             C00008 - |  VDP_VBlank :                   248 C |
*VDP_VBlank105 :                 38 C | *VERSION :                     142F - |
*VFLIP :                       1000 - | *VRAM :                    40000000 - |
*VRAM_DMA_CMD :            40000080 - | *VRAM_SIZE :                  10000 - |
*VSRAM :                   40000010 - | *VSRAM_DMA_CMD :           40000090 - |
*VSRAM_SIZE :                    50 - | *WARNRELATIVE :                   0 - |
 WINDOW_ADDR :                 FFFF - | *WRAM_ADDR :                 FF0000 - |
*WRAM_SIZE :                  10000 - |  Wait68k :                       4D C |
 Wait68k.continue :              50 C | *YM2612_CONTROL :              4000 - |
 YM2612_DATA :                 4001 - |  Z80RomEnd :                    770 C |
 Z80RomStart :                  6E0 C |  Z80RoutineAddress :             5E C |
 Z80_BUSREQ :                A11100 - |  Z80_RAM :                   A00000 - |
 Z80_RESET :                 A11200 - |  accurateSpeed :                  1 - |
 continue89 :                   2D0 C |  copy_program99 :               6AA C |
 disableCPU100 :                6DC C |  i :                            430 - |
 loop_endSound1109 :             69 C |  playedSamplesHigh :           1000 C |
 playedSamplesLow :            1002 C |  sampleIndex :             FFFF0000 C |
 shouldStop :              FFFF0004 C |  skip_alignment89 :             296 C |
 skip_tracking89 :              2C8 C |  smoothPlayback :                 1 - |
 timing_wait189 :               2D2 C |  timing_wait298 :               63C C |
 wait99 :                       6C6 C |  z80_wait89 :                   268 C |

    135 symbols
     63 unused symbols

 AS V1.42 Beta [Bld 298] - Source File Sonic.68k - Page 4 - 12/17/2025 22:12:31


  Defined Macros:
  ---------------

addaq                                 | assertZ80Reset                       
deassertZ80Reset                      | loadSamples                          
loadSamplesAlt                        | loopTest                             
startZ80                              | stopZ80                              
subaq                                 | waitZ80                              

     10 macros

 AS V1.42 Beta [Bld 298] - Source File Sonic.68k - Page 5 - 12/17/2025 22:12:31


  Defined Functions:
  ------------------

notaddressregister                    | notdataregister                      

 AS V1.42 Beta [Bld 298] - Source File Sonic.68k - Page 6 - 12/17/2025 22:12:31


  Code Pages:
  ----------

STANDARD (0 changed characters)

1 code page

0.05 seconds assembly time

   1296 lines source file
   2196 lines incl. macro expansions
      2 passes
      0 errors
      0 warnings
